# Specification Generator
Генератор спецификаций QR кодов из мастер файла

Этот проект представляет собой Python-скрипт, реализованный в виде класса `SpecificationGenerator`, который создает спецификацию на основе данных из двух файлов Excel (`Мастер файл номенклатуры.xlsx` и `FORT_QR_20250326145347.xlsx`) и сохраняет результат в новый файл, используя шаблон `Invoice Specification template.xlsx`.

## Назначение

Скрипт предназначен для:
- Обработки данных о товарах из мастер-файла и QR-кодов из файла FORT_QR.
- Сопоставления кодов GTIN и GTIN Outer между файлами.
- Формирования спецификации с учетом количества пачек в коробках (по колонке `SIZE5`).
- Проверки корректности распределения пачек по коробкам (отсутствие остатка).
- Сохранения результата в новый файл Excel с уникальным именем.

## Зависимости

Для работы скрипта требуются следующие библиотеки:
- `pandas` — для работы с данными в формате таблиц.
- `openpyxl` — для чтения и записи файлов Excel.
- `shutil` — для копирования файлов.
- `datetime` — для генерации уникальных имен файлов с временной меткой.

Установка зависимостей с использованием `uv`:
```bash
uv venv
source .venv/bin/activate  # Linux/MacOS, или .venv\Scripts\activate для Windows
uv pip install pandas openpyxl
```

## Вызов класса
Скрипт запускается через создание экземпляра класса и вызов метода run():

```
if __name__ == "__main__":
    generator = SpecificationGenerator(
        master_file_path="Мастер файл номенклатуры.xlsx",
        fort_qr_path="FORT_QR_20250326145347.xlsx",
        template_path="Invoice Specification template.xlsx"
    )
    generator.run()
```
## Особенности

- **Проверка остатка**: Если количество пачек (`GTIN`) не делится нацело на `SIZE5`, скрипт останавливается с ошибкой.
- **Отладочная информация**: Выводятся данные о текущем `GTIN Outer`, количестве пачек, коробок и остатке.
- **Шаблон**: Исходный шаблон не изменяется, данные записываются в новый файл.

## Использование

1. Поместите файлы `Мастер файл номенклатуры.xlsx`, `FORT_QR_20250326145347.xlsx` и `Invoice Specification template.xlsx` в директорию со скриптом.
2. Установите зависимости (см. выше).
3. Запустите скрипт:
```
python script.py
```
