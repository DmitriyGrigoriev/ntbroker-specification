# Specification Generator
–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π QR –∫–æ–¥–æ–≤ –∏–∑ –º–∞—Å—Ç–µ—Ä —Ñ–∞–π–ª–∞

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π Python-—Å–∫—Ä–∏–ø—Ç, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –≤ –≤–∏–¥–µ –∫–ª–∞—Å—Å–∞ `SpecificationGenerator`, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –¥–≤—É—Ö —Ñ–∞–π–ª–æ–≤ Excel (–º–∞—Å—Ç–µ—Ä-—Ñ–∞–π–ª –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã –∏ —Ñ–∞–π–ª QR-–∫–æ–¥–æ–≤ FORT) –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –Ω–æ–≤—ã–π —Ñ–∞–π–ª, –∏—Å–ø–æ–ª—å–∑—É—è —à–∞–±–ª–æ–Ω —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏.

## üìã –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è:
- –û–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ —Ç–æ–≤–∞—Ä–∞—Ö –∏–∑ –º–∞—Å—Ç–µ—Ä-—Ñ–∞–π–ª–∞ –∏ QR-–∫–æ–¥–æ–≤ –∏–∑ —Ñ–∞–π–ª–∞ FORT_QR
- –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∫–æ–¥–æ–≤ GTIN –º–µ–∂–¥—É –º–∞—Å—Ç–µ—Ä-—Ñ–∞–π–ª–æ–º –∏ —Ñ–∞–π–ª–æ–º QR-–∫–æ–¥–æ–≤
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∏–µ—Ä–∞—Ä—Ö–∏–∏: –ø–∞—á–∫–∞ ‚Üí –∫–æ—Ä–æ–±–∫–∞ ‚Üí –º–∞—Å—Ç–µ—Ä-–∫–µ–π—Å ‚Üí –ø–∞–ª–ª–µ—Ç
- –í–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —É–ø–∞–∫–æ–≤–∫–∞–º (SIZE5 –∏ SIZE2)
- –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Ç–æ–≥–æ–≤–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å –∫–æ–¥–∞–º–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ –Ω–æ–≤—ã–π —Ñ–∞–π–ª Excel —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∏–º–µ–Ω–µ–º –∏ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–æ–π

## üóÉÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

#### –í—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã:
- **–ú–∞—Å—Ç–µ—Ä-—Ñ–∞–π–ª –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã** - —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–≤–∞—Ä–∞—Ö, GTIN –∫–æ–¥–∞—Ö –∏ —Ä–∞–∑–º–µ—Ä–∞—Ö —É–ø–∞–∫–æ–≤–æ–∫
- **FORT_QR —Ñ–∞–π–ª** - —Å–æ–¥–µ—Ä–∂–∏—Ç QR-–∫–æ–¥—ã –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏ —Å –∫–æ–¥–∞–º–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **–®–∞–±–ª–æ–Ω —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏** - –±–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω –¥–ª—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

### –ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è:
- `GTIN` - –∫–æ–¥ —Ç–æ–≤–∞—Ä–∞ (–ø–∞—á–∫–∞)
- `GTIN Outer` - –∫–æ–¥ –∫–æ—Ä–æ–±–∫–∏
- `GTIN Case` - –∫–æ–¥ –º–∞—Å—Ç–µ—Ä-–∫–µ–π—Å–∞
- `SIZE5` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—á–µ–∫ –≤ –∫–æ—Ä–æ–±–∫–µ
- `SIZE2` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—Å—Ç–µ—Ä-–∫–µ–π—Å–æ–≤ –Ω–∞ –ø–∞–ª–ª–µ—Ç–µ
- `identificationCode` - –∫–æ–¥ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏

## üèóÔ∏è –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞ —Ç—Ä–µ–±—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
- `pandas` ‚Äî –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ —Ç–∞–±–ª–∏—Ü
- `openpyxl` ‚Äî –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–æ–≤ Excel
- `shutil` ‚Äî –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- `datetime` ‚Äî –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤ —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–æ–π

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `uv`:
```bash
uv venv
source .venv/bin/activate  # Linux/MacOS, –∏–ª–∏ .venv\Scripts\activate –¥–ª—è Windows
uv pip install pandas openpyxl
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏-–æ–±–µ—Ä—Ç–∫–∏
```
def generate_specification(master_file_path, fort_qr_path, template_path):
    generator = SpecificationGenerator(master_file_path, fort_qr_path, template_path)
    master_file, fort_qr = generator.load_data()
    row_count = generator.process_data(master_file, fort_qr)
    generator.save_to_excel(row_count)
    return generator.new_filename

result_file = generate_specification(
    "–ú–∞—Å—Ç–µ—Ä —Ñ–∞–π–ª –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã.xlsx",
    "FORT_QR_20250326145347.xlsx", 
    "Invoice Specification template.xlsx"
)
```

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö: –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —É–ø–∞–∫–æ–≤–∫–∞–º
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤: –ï—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—á–µ–∫ –Ω–µ –¥–µ–ª–∏—Ç—Å—è –Ω–∞—Ü–µ–ª–æ –Ω–∞ SIZE5, –∏–ª–∏ –º–∞—Å—Ç–µ—Ä-–∫–µ–π—Å–æ–≤ –Ω–∞ SIZE2, —Å–∫—Ä–∏–ø—Ç –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π
- –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: –í—ã–≤–æ–¥—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è—Ö GTIN –∫–æ–¥–æ–≤ –∏ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞: –ò—Å—Ö–æ–¥–Ω—ã–π —à–∞–±–ª–æ–Ω –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è, –¥–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –Ω–æ–≤—ã–π —Ñ–∞–π–ª
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞: –í—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–æ–ª—É—á–∞—é—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–æ–π

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
–†–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏:

- productNameRus - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ —Ä—É—Å—Å–∫–æ–º
- productNameEng - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º
- identificationCode - –∫–æ–¥ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–∞—á–∫–∏
- identificationCodeOuter - –∫–æ–¥ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–æ—Ä–æ–±–∫–∏
- identificationCodeCase - –∫–æ–¥ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –º–∞—Å—Ç–µ—Ä-–∫–µ–π—Å–∞
- identificationCodePallet - –∫–æ–¥ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–∞–ª–ª–µ—Ç–∞
- invoiceNo - –Ω–æ–º–µ—Ä –∏–Ω–≤–æ–π—Å–∞
- invoiceDate - –¥–∞—Ç–∞ –∏–Ω–≤–æ–π—Å–∞
- TotalAmount - –æ–±—â–∞—è —Å—É–º–º–∞

## üìù –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
1. –ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å–æ —Å–∫—Ä–∏–ø—Ç–æ–º:

    - –ú–∞—Å—Ç–µ—Ä-—Ñ–∞–π–ª –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã (Excel)
    - –§–∞–π–ª FORT_QR —Å QR-–∫–æ–¥–∞–º–∏ (Excel)
    - –®–∞–±–ª–æ–Ω —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ (Excel)
    - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```
uv pip install pandas openpyxl
```
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç:
```
python script.py
```
4. –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ñ–∞–π–ª —Å –∏–º–µ–Ω–µ–º –≤–∏–¥–∞ 
```
Invoice_Specification_YYYYMMDD_HHMMSS.xlsx
```

## ‚ö†Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
–°–∫—Ä–∏–ø—Ç –≤–∫–ª—é—á–∞–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –∏ –≤—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö:

- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≤—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —É–ø–∞–∫–æ–≤–∫–∞–º
- –ö–æ–Ω—Ç—Ä–æ–ª—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ GTIN –∫–æ–¥–æ–≤
- –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è
MIT License ¬© 2025 Dmitriy Grigoriev